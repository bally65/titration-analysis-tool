<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>氯化鐵檢測 | Ferric Chloride Detection</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>氯化鐵檢測</h1>
            <p class="subtitle">Ferric Chloride Detection</p>
            <p class="description">專業化學分析工具，自動計算樣品含量與消耗體積。</p>
        </header>

        <main>
            <section class="calculator-card">
                <div class="card-header">
                    <h2>實驗數據輸入</h2>
                </div>
                
                <div class="input-grid">
                    <div class="input-group" id="group-name">
                        <label for="sample-name">樣品名稱 (Name)</label>
                        <div class="input-wrapper">
                            <input type="text" id="sample-name" placeholder="請輸入樣品名稱">
                        </div>
                    </div>

                    <div class="input-group" id="group-a">
                        <label for="initial-reading">滴定管初始讀數 (A)</label>
                        <div class="input-wrapper">
                            <input type="number" id="initial-reading" step="0.01" placeholder="0.00">
                            <span class="unit">mL</span>
                        </div>
                    </div>

                    <div class="input-group" id="group-b">
                        <label for="final-reading">滴定管最終讀數 (B)</label>
                        <div class="input-wrapper">
                            <input type="number" id="final-reading" step="0.01" placeholder="0.00">
                            <span class="unit">mL</span>
                        </div>
                    </div>

                    <div class="input-group" id="group-c">
                        <label for="sample-weight">樣品重量 (C)</label>
                        <div class="input-wrapper">
                            <input type="number" id="sample-weight" step="0.0001" placeholder="0.0000">
                            <span class="unit">g</span>
                        </div>
                    </div>

                    <div class="input-group" id="group-f">
                        <label for="factor">換算因子 (F) <small>(預設為 3.244)</small></label>
                        <div class="input-wrapper">
                            <input type="number" id="factor" step="0.0001" value="3.2440">
                        </div>
                    </div>
                </div>

                <div class="error-msg" id="error-display"></div>

                <hr>

                <div class="result-section">
                    <div class="result-item">
                        <span class="result-label">消耗體積 (V):</span>
                        <span class="result-value" id="v-diff">0.00</span>
                        <span class="result-unit">mL</span>
                    </div>
                    <div class="result-main">
                        <span class="result-label">最終分析結果:</span>
                        <span class="result-value highlighted" id="final-result">0.0000</span>
                    </div>
                </div>

                <div class="action-buttons">
                    <button id="full-reset-btn" class="btn-purple">🔄 全面重置</button>
                    <button id="reset-btn" class="btn-danger">🧹 清除數值</button>
                    <button id="add-record" class="btn-primary">💾 保存此紀錄</button>
                </div>
            </section>

            <section class="history-section">
                <div class="section-header">
                    <h2>實驗紀錄表 (History)</h2>
                    <div class="export-group">
                        <button id="export-csv" class="btn-secondary">CSV</button>
                        <button id="export-word" class="btn-secondary">Word</button>
                        <button id="export-pdf" class="btn-secondary">PDF</button>
                        <button id="clear-history" class="btn-danger-small">清空列表</button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="history-table">
                        <thead>
                            <tr>
                                <th>案號</th>
                                <th>樣品名稱</th>
                                <th>初始 (mL)</th>
                                <th>最終 (mL)</th>
                                <th>消耗 (mL)</th>
                                <th>重量 (g)</th>
                                <th>結果</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Records added here -->
                        </tbody>
                    </table>
                </div>
                <div id="average-display" class="average-box">
                    平均值 (Average): <span id="avg-result">---</span>
                </div>
            </section>
        </main>

        <footer>
            <p>© 2026 Molty Lab Assistant | Designed for Bally</p>
        </footer>
    </div>
    <!-- Scripts for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="script.js?v=1.3"></script>
</body>
</html>
